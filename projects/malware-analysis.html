<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="keywords"
      content="Malware Analysis, Reverse Engineering, Incident Response, Static Analysis, Dynamic Analysis, CS 6262"
    />
    <title>Malware Analysis Project - Mason Kim</title>
    <link rel="stylesheet" href="../styles.css" />
    <link rel="stylesheet" href="project-details.css" />
  </head>
  <body class="dark-theme">
    <nav class="navbar">
      <div class="nav-content">
        <a href="../index.html" class="nav-brand">Mason Kim</a>
        <div class="nav-links">
          <a href="../index.html#about">About</a>
          <a href="../index.html#experience">Experience</a>
          <a href="../index.html#projects">Projects</a>
          <a href="../index.html#contact">Contact</a>
        </div>
      </div>
    </nav>

    <main class="project-detail">
      <header class="project-header">
        <div class="container">
          <h1>Malware Analysis</h1>
          <div class="project-meta">
            <span class="project-period">CS 6262 – Project 2</span>
            <span class="project-status">Completed</span>
          </div>
          <div class="project-tags">
            <span class="tech-tag">Malware Analysis</span>
            <span class="tech-tag">Reverse Engineering</span>
            <span class="tech-tag">Incident Response</span>
            <span class="tech-tag">Static Analysis</span>
            <span class="tech-tag">Dynamic Analysis</span>
            <span class="tech-tag">CS 6262</span>
          </div>
        </div>
      </header>

      <section class="project-content container">
        <div class="project-overview">
          <h2>Project Overview</h2>
          <p>
            This project examined multiple Windows malware samples through a
            disciplined blend of static and dynamic analysis. Each sample
            underwent initial triage—hashing, VirusTotal lookups, and packer
            detection—before deeper reverse engineering and sandbox execution.
          </p>
          <p>
            The analysis exposed command-and-control domains, persistence
            mechanisms, and system modifications. These findings were distilled
            into a comprehensive list of indicators of compromise (IOCs) and
            mapped to actionable remediation strategies for enterprise
            defenders.
          </p>
        </div>

        <div class="project-objectives">
          <h2>Objectives &amp; Scope</h2>
          <ul>
            <li>
              Compute MD5/SHA256 hashes and query VirusTotal/Hybrid Analysis for
              reputation
            </li>
            <li>
              Inspect PE headers and section layout to identify packers or
              obfuscation
            </li>
            <li>
              Reverse engineer critical functions and strings using Ghidra and
              IDA Pro
            </li>
            <li>
              Prepare a Windows 10 VM with ProcMon, RegShot, x64dbg, and
              Wireshark for runtime inspection
            </li>
            <li>
              Monitor spawned processes, file and registry modifications, and
              network traffic during execution
            </li>
            <li>
              Catalog IOC details and propose mitigation steps based on observed
              behavior
            </li>
          </ul>
        </div>

        <div class="project-environment">
          <h2>Environment &amp; Tools</h2>
          <h3>Virtualization</h3>
          <ul>
            <li>
              VirtualBox Windows 10 snapshot with host-only networking to block
              internet access and emulate C2 servers
            </li>
          </ul>
          <h3>Static Tools</h3>
          <ul>
            <li>
              Ghidra / IDA Pro – reverse engineering functions and control flow
            </li>
            <li>PEview – examine PE structure and headers</li>
            <li>
              Strings – extract printable text for quick indicator discovery
            </li>
            <li>YARA – match custom signatures against file contents</li>
          </ul>
          <h3>Dynamic Tools</h3>
          <ul>
            <li>
              Process Monitor – track filesystem, registry, and process activity
            </li>
            <li>RegShot – snapshot and diff registry changes</li>
            <li>x64dbg – debug runtime behavior and set breakpoints</li>
            <li>Wireshark / Fiddler – capture and inspect network packets</li>
          </ul>
          <h3>Other Utilities</h3>
          <ul>
            <li>
              RegShot comparisons and automation scripts to streamline sandbox
              resets
            </li>
          </ul>
          <figure>
            <img
              src="https://github.com/user-attachments/assets/985d5d82-9598-4e7e-9c0b-22eea1f0ddcb"
              alt="Analysis Environment Architecture diagram"
            />
            <figcaption>Figure 2. Analysis Environment Architecture</figcaption>
          </figure>
        </div>

        <div class="project-methodology">
          <h2>Methodology</h2>
          <h3>Preparation &amp; Triage</h3>
          <ul>
            <li>
              Calculated hashes and scanned samples with antivirus engines and
              online services
            </li>
            <li>
              Identified packers and obfuscators to guide further analysis
            </li>
          </ul>
          <h3>Static Analysis</h3>
          <ul>
            <li>
              Examined PE headers, imports, and section entropy for anomalies
            </li>
            <li>Extracted and reviewed strings and embedded resources</li>
            <li>
              Disassembled code to understand control flow and deobfuscate
              routines
            </li>
          </ul>
          <h3>Dynamic Analysis Setup</h3>
          <ul>
            <li>Restored clean VM snapshots and installed monitoring tools</li>
            <li>
              Isolated network connectivity and configured a simulated C2 server
            </li>
          </ul>
          <h3>Execution &amp; Monitoring</h3>
          <ul>
            <li>
              Ran samples while logging file, registry, and process changes
            </li>
            <li>Traced API calls and watched for suspicious system behavior</li>
            <li>Captured network traffic to inspect protocols and payloads</li>
          </ul>
          <h3>Deobfuscation &amp; Decoding</h3>
          <ul>
            <li>
              Unpacked runtime-packed binaries and analyzed any dropped
              artifacts
            </li>
            <li>Decoded custom encryption and communication protocols</li>
          </ul>
          <h3>IOC Extraction &amp; Reporting</h3>
          <ul>
            <li>
              Compiled domains, IP addresses, mutexes, registry keys, and file
              paths into an IOC table
            </li>
            <li>
              Documented a timeline of activity and drafted remediation guidance
            </li>
          </ul>
          <figure>
            <img
              src="https://github.com/user-attachments/assets/208ecafe-f0bf-4758-aaa8-1263e35b08a8"
              alt="Malware Analysis Process diagram"
            />
            <figcaption>Figure 1. Malware Analysis Process</figcaption>
          </figure>
        </div>

        <div class="project-findings">
          <h2>Key Findings</h2>
          <ul>
            <li>
              Performed process injection into <code>svchost.exe</code> to
              masquerade as a legitimate Windows service
            </li>
            <li>
              Created persistence by adding an <code>Updater</code> value to
              <code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code>
            </li>
            <li>
              Maintained C2 communication via periodic HTTP POST requests to
              <code>mal.example.com:80</code> with encrypted JSON payloads
            </li>
            <li>
              Used a custom XOR cipher instead of TLS and forged the User-Agent
              string as “Mozilla/5.0 (Windows NT 10.0; Win64; x64)”
            </li>
          </ul>
        </div>

        <div class="project-remediation">
          <h2>Remediation &amp; Recommendations</h2>
          <ul>
            <li>
              Add identified C2 domains and IP addresses to firewall rules, DNS
              filters, and proxy block lists
            </li>
            <li>
              Distribute YARA signatures to EDR/AV platforms and craft Sysmon
              rules for injection and registry tampering
            </li>
            <li>
              Educate users on spear-phishing risks and enforce prompt security
              patching
            </li>
            <li>
              Apply least privilege and application whitelisting to detect
              privilege escalation attempts
            </li>
            <li>
              Segment internal networks and aggregate logs to disrupt lateral
              movement early
            </li>
          </ul>
        </div>

        <div class="project-lessons">
          <h2>Challenges &amp; Lessons Learned</h2>
          <ul>
            <li>
              Bypassing obfuscation and packing required custom unpacking
              scripts, which improved workflow efficiency
            </li>
            <li>
              Kernel-level behavior analysis necessitated a kernel debugger to
              observe driver interactions
            </li>
            <li>
              Automation scripts parsed ProcMon logs to extract IOCs, reducing
              analysis time by roughly 30%
            </li>
          </ul>
        </div>

        <div class="project-future">
          <h2>Future Work</h2>
          <ul>
            <li>
              Extend research to ransomware and cryptocurrency miner families
            </li>
            <li>
              Develop machine-learning models for automated malware
              classification
            </li>
            <li>
              Build a fully automated analysis pipeline and contribute
              enhancements to open-source tools
            </li>
          </ul>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="container">
        <p>&copy; 2025 Mason Kim. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
